<script lang="ts" setup>
import { smallPhoneNum, whatsapplink } from '~/assets/js/common'
import { useAppState } from '~/stores/appState'
const appState = useAppState()
const toContactUs = () => {
  const el = document.getElementById('contactUsFormNav')
  if (el) {
    el.scrollIntoView({ behavior: 'smooth' })
  }
}

const { width, height } = useWindowSize()
const { x, y } = useWindowScroll()
let _opacity = ref(1)
let _visibility: any = ref('unset')
let _top = ref('auto')
const changeConfig = () => {
  if (y.value > (width.value * (580 / 1920)) / 2) {
    _opacity.value = 1
    _visibility.value = 'unset'
    _top.value = '40vh'
  } else {
    _opacity.value = 0
    _visibility.value = 'hidden'
    _top.value = '40vh'
  }
}
watch(y, (n, o) => {
  if (width.value > 768) {
    changeConfig()
  }
})
const pathLink = ref('')
const closeAd = ref(false)

onMounted(() => {
  if (width.value > 768) {
    changeConfig()
  }
})

const smoothScrollToTop = () => {
  window.scrollTo({
    top: 0,
    behavior: 'smooth', // 平滑滚动
  })
}
</script>

<template>
  <div
    v-if="width > 768"
    class="pc_side"
    :style="{
      'z-index': appState.isShowForm ? 100 : 50,
      opacity: width > 768 ? _opacity : 1,
      visibility: width > 768 ? _visibility : 'initial',
      top: width > 768 ? _top : 'auto',
    }"
  >
    <a :href="whatsapplink" target="_blank" class="whatpsApp">
      <div class="whatsApp_text">WhatsApp</div>
      <div class="whatsApp_svg">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="66"
          height="66"
          viewBox="0 0 66 66"
          fill="none"
        >
          <circle cx="33" cy="33" r="33" fill="#31D851" />
          <path
            d="M12.9062 53.536L15.8012 42.7816C13.4665 38.5922 12.7247 33.7035 13.712 29.0127C14.6993 24.3218 17.3494 20.1434 21.176 17.2442C25.0027 14.345 29.7491 12.9194 34.5444 13.2291C39.3397 13.5389 43.8622 15.5631 47.282 18.9303C50.7018 22.2976 52.7895 26.782 53.1621 31.5607C53.5346 36.3394 52.167 41.0918 49.3101 44.9459C46.4533 48.8 42.2989 51.4972 37.6092 52.5426C32.9195 53.588 28.0092 52.9114 23.7793 50.6371L12.9062 53.536ZM24.3036 46.6127L24.976 47.0106C28.0398 48.822 31.6183 49.5716 35.1539 49.1426C38.6894 48.7135 41.9833 47.13 44.5224 44.6387C47.0614 42.1474 48.7029 38.8883 49.1911 35.3693C49.6793 31.8503 48.9867 28.2691 47.2213 25.1837C45.4559 22.0983 42.7168 19.682 39.431 18.3115C36.1451 16.941 32.497 16.6931 29.0551 17.6066C25.6133 18.52 22.5711 20.5435 20.4025 23.3616C18.234 26.1797 17.061 29.6342 17.0663 33.1868C17.0634 36.1324 17.8801 39.021 19.4255 41.5311L19.8472 42.2246L18.2288 48.227L24.3036 46.6127Z"
            fill="white"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M40.6242 35.9482C40.23 35.6311 39.7684 35.4079 39.2746 35.2956C38.7809 35.1833 38.2679 35.1849 37.7748 35.3002C37.034 35.6072 36.5553 36.7667 36.0766 37.3465C35.9757 37.4855 35.8274 37.583 35.6595 37.6207C35.4916 37.6583 35.3158 37.6336 35.1649 37.5511C32.4527 36.4916 30.1793 34.5485 28.714 32.0375C28.589 31.8808 28.5299 31.6819 28.549 31.4825C28.5681 31.2832 28.664 31.0991 28.8166 30.9689C29.3505 30.4417 29.7425 29.7887 29.9563 29.0704C30.0038 28.278 29.8218 27.4888 29.432 26.7967C29.1307 25.8265 28.5572 24.9626 27.7794 24.3071C27.3782 24.1271 26.9334 24.0667 26.4986 24.1333C26.0638 24.1999 25.6576 24.3905 25.329 24.6822C24.7585 25.1731 24.3057 25.7855 24.0039 26.4741C23.7021 27.1627 23.5591 27.91 23.5852 28.6611C23.587 29.0829 23.6406 29.5029 23.7448 29.9116C24.0094 30.8938 24.4164 31.8321 24.9529 32.6969C25.3399 33.3593 25.7622 34.0007 26.218 34.6181C27.6991 36.6462 29.5609 38.3682 31.7001 39.6884C32.7735 40.3593 33.9208 40.9048 35.1193 41.3141C36.3642 41.8769 37.7388 42.093 39.0969 41.9393C39.8708 41.8225 40.604 41.5177 41.232 41.0519C41.86 40.586 42.3636 39.9733 42.6985 39.2678C42.8952 38.8415 42.955 38.365 42.8694 37.9036C42.6643 36.96 41.3992 36.4029 40.6242 35.9482Z"
            fill="white"
          />
        </svg>
      </div>
    </a>
    <a :href="`tel: 852 ${smallPhoneNum}`" class="phone">
      <div class="phone_text">（852）{{ smallPhoneNum }}</div>
      <div class="phone_svg">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="66"
          height="66"
          viewBox="0 0 66 66"
          fill="none"
        >
          <circle cx="33" cy="33" r="33" fill="#FFA8C6" />
          <path
            d="M44.6396 52C44.4937 52 44.3437 52 44.1957 51.9786C36.7141 51.2482 29.7227 48.0299 24.4061 42.869C19.0895 37.7081 15.7746 30.922 15.0231 23.6605C14.9608 23.0837 15.025 22.5006 15.2114 21.9496C15.3979 21.3986 15.7025 20.8922 16.105 20.4636C16.5371 20.0022 17.0639 19.6338 17.6515 19.3821C18.2391 19.1304 18.8745 19.0009 19.5169 19.0019H25.0386C26.0157 19.0009 26.9682 19.2987 27.761 19.8531C28.5537 20.4075 29.1462 21.1903 29.4544 22.0902L31.2543 27.3019C31.529 28.0985 31.5684 28.9538 31.368 29.771C31.1676 30.5882 30.7354 31.3345 30.1203 31.9255L29.2564 32.7641C30.6934 34.9298 32.597 36.7675 34.8361 38.1505L35.6841 37.3256C36.2957 36.7328 37.0652 36.3168 37.9065 36.1242C38.7478 35.9315 39.6277 35.9698 40.4478 36.2347L45.8176 37.9816C46.7432 38.2802 47.5485 38.8539 48.1196 39.6213C48.6906 40.3888 48.9984 41.3111 48.9994 42.2578V47.6171C49.0182 48.7589 48.5698 49.8613 47.7526 50.6829C46.9354 51.5044 45.816 51.9781 44.6396 52ZM19.5169 22.0145C19.3133 22.0099 19.111 22.0473 18.9235 22.1243C18.7359 22.2012 18.5674 22.316 18.4289 22.4609C18.3137 22.5821 18.2259 22.7254 18.1711 22.8815C18.1164 23.0376 18.0959 23.2031 18.1109 23.3674C18.7943 29.9369 21.7952 36.0756 26.6057 40.7446C31.4162 45.4136 37.741 48.3261 44.5097 48.9894H44.6236C44.7889 48.9871 44.9521 48.9527 45.1035 48.8884C45.255 48.8241 45.3917 48.7311 45.5056 48.6148C45.7677 48.3463 45.9113 47.9889 45.9056 47.619V42.2578C45.9055 41.9416 45.8028 41.6335 45.6122 41.3771C45.4216 41.1207 45.1527 40.929 44.8436 40.8292L39.4739 39.0919C39.2006 39.0034 38.9073 38.9905 38.6268 39.0546C38.3464 39.1187 38.0898 39.2573 37.886 39.4549L37.028 40.2896C36.4467 40.8514 35.6605 41.1681 34.8401 41.1708C34.2268 41.1715 33.6278 40.9915 33.1222 40.6545C30.525 39.0442 28.3156 36.9098 26.6445 34.3965C26.2576 33.8219 26.0865 33.1354 26.1601 32.4527C26.2337 31.77 26.5474 31.1328 27.0485 30.6483L27.9265 29.7962C28.1311 29.599 28.2745 29.3499 28.3403 29.0774C28.406 28.8049 28.3916 28.5199 28.2984 28.255L26.5105 23.0452C26.4086 22.745 26.2116 22.4837 25.9476 22.2987C25.6837 22.1136 25.3662 22.0141 25.0406 22.0145H19.5169ZM47.4475 31.0501C47.0361 31.0496 46.6416 30.8907 46.3507 30.6084C46.0598 30.326 45.8961 29.9432 45.8956 29.5439C45.8935 27.5471 45.0753 25.6326 43.6205 24.2207C42.1658 22.8087 40.1933 22.0146 38.136 22.0125C37.7244 22.0125 37.3296 21.8538 37.0386 21.5714C36.7475 21.2889 36.584 20.9058 36.584 20.5063C36.584 20.1068 36.7475 19.7237 37.0386 19.4412C37.3296 19.1587 37.7244 19 38.136 19C41.0162 19.0031 43.7775 20.1149 45.8141 22.0916C47.8507 24.0683 48.9963 26.7484 48.9994 29.5439C48.9989 29.9432 48.8352 30.326 48.5443 30.6084C48.2534 30.8907 47.8589 31.0496 47.4475 31.0501ZM41.2478 31.0501C40.8364 31.0496 40.4419 30.8907 40.151 30.6084C39.8601 30.326 39.6964 29.9432 39.6959 29.5439C39.6954 29.1445 39.5317 28.7617 39.2408 28.4793C38.9498 28.197 38.5554 28.0381 38.144 28.0376C37.7321 28.0376 37.3371 27.8788 37.0459 27.5961C36.7546 27.3135 36.591 26.9301 36.591 26.5304C36.591 26.1306 36.7546 25.7472 37.0459 25.4646C37.3371 25.1819 37.7321 25.0231 38.144 25.0231C39.3788 25.0241 40.5627 25.5008 41.4356 26.3485C42.3086 27.1961 42.7992 28.3454 42.7997 29.5439C42.7995 29.7422 42.7589 29.9386 42.6803 30.1218C42.6017 30.3049 42.4867 30.4712 42.3418 30.6111C42.1969 30.751 42.0249 30.8618 41.8359 30.9372C41.6468 31.0125 41.4442 31.0509 41.2398 31.0501H41.2478Z"
            fill="white"
          />
        </svg>
      </div>
    </a>
    <div class="btn" @click="toContactUs">
      <div class="btn_text">立即預約</div>
      <div class="btn_svg">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="66"
          height="66"
          viewBox="0 0 66 66"
          fill="none"
        >
          <circle cx="33" cy="33" r="33" fill="#FFA8C6" />
          <path
            d="M35.9948 37.5673L28 39L29.3325 30.9344L44.6026 15.7848C44.8504 15.5361 45.1451 15.3387 45.4699 15.204C45.7946 15.0693 46.1429 15 46.4947 15C46.8466 15 47.1949 15.0693 47.5196 15.204C47.8444 15.3387 48.1391 15.5361 48.3869 15.7848L51.2117 18.5972C51.4615 18.8438 51.6597 19.1372 51.795 19.4606C51.9303 19.7839 52 20.1307 52 20.4809C52 20.8312 51.9303 21.1779 51.795 21.5013C51.6597 21.8246 51.4615 22.118 51.2117 22.3647L35.9948 37.5673Z"
            stroke="white"
            stroke-width="3.5"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <path
            d="M48 38.5652V46.3913C48 47.0832 47.7252 47.7467 47.2359 48.2359C46.7467 48.7252 46.0832 49 45.3913 49H20.6087C19.9168 49 19.2533 48.7252 18.7641 48.2359C18.2748 47.7467 18 47.0832 18 46.3913V21.6087C18 20.9168 18.2748 20.2533 18.7641 19.7641C19.2533 19.2748 19.9168 19 20.6087 19H28.4348"
            stroke="white"
            stroke-width="3.5"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </div>
    </div>
    <div class="scroll_top" @click="smoothScrollToTop">
      <div style="padding: 0"></div>
      <div>
        <img
          src="https://static.cmereye.com/imgs/2024/10/1380fb22f597a323.png"
          alt=""
        />
      </div>
    </div>
  </div>
</template>

<style lang="scss" scoped>
.pc_side {
  position: fixed;
  right: 3.5vw;
  top: 40vh;
  z-index: 99;
  & > a,
  & > div {
    display: block;
    cursor: pointer;
    margin-bottom: 15px;
    position: relative;
    & > div:nth-child(1) {
      width: 0;
      position: absolute;
      right: 35%;
      box-sizing: border-box;
      padding: 0;
      border-radius: 35px;
      background: var(--Theme-Color, #fc1682);
      transform: translateY(-50%);
      top: 50%;
      color: #fff;
      text-align: center;
      font-family: FakePearl;
      font-size: 0;
      font-style: normal;
      font-weight: 600;
      line-height: 160%; /* 41.6px */
      letter-spacing: 1.3px;
      opacity: 0;
      height: 0;
      transition: all 0s;
    }
    & > div:nth-child(2) {
      position: relative;
      z-index: 5;
    }
  }
}
.whatpsApp:hover {
  .whatsApp_text {
    opacity: 1;
    transition: all 0.5s;
    width: max-content;
    font-size: 26px;
    padding: 5px 57px 5px 20px;
    height: auto;
  }
  .whatsApp_svg {
    transition: all 0.5s;
    filter: drop-shadow(0px 0px 10px rgba(252, 22, 130, 0.5));
  }
}
.phone:hover {
  .phone_text {
    opacity: 1;
    transition: all 0.5s;
    width: max-content;
    font-size: 26px;
    padding: 5px 57px 5px 20px;
    height: auto;
  }
  .phone_svg {
    transition: all 0.5s;
    filter: drop-shadow(0px 0px 10px rgba(252, 22, 130, 0.5));
  }
}
.btn:hover {
  .btn_text {
    opacity: 1;
    transition: all 0.5s;
    width: max-content;
    font-size: 26px;
    padding: 5px 57px 5px 20px;
    height: auto;
  }
  .btn_svg {
    transition: all 0.5s;
    filter: drop-shadow(0px 0px 10px rgba(252, 22, 130, 0.5));
  }
}
.scroll_top:hover {
  transition: all 0.5s;
  filter: drop-shadow(0px 0px 10px rgba(252, 22, 130, 0.5));
}
@media screen and (max-width: 768px) {
  .pc_side {
    display: none !important;
  }
}
</style>